'use strict';

var themes = require('../../themes');
var tools = require('../../tools');

var chalk = require('chalk');
var dot = require('dotty');
var noon = require('noon');

var CFILE = process.env.HOME + '/.leximaven.noon';

exports.command = 'set <key> <value>';
exports.desc = 'Set a config value';
exports.builder = {};
exports.handler = function (argv) {
  var key = argv.key;
  var value = argv.value;
  value = tools.checkBoolean(value);
  tools.checkConfig(CFILE);
  var config = noon.load(CFILE);
  var theme = themes.loadTheme(config.theme);
  if (config.verbose) themes.labelDown('Configuration', theme, null);
  if (dot.exists(config, key)) {
    if (/\./i.test(key)) {
      if (/^\w*\.date/i.test(key)) {
        throw new Error("API limits hardcoded, can't set this key.");
      } else {
        dot.put(config, key, value);
      }
    } else {
      config[key] = value;
    }
  } else {
    throw new Error('Option ' + key + ' not found.');
  }
  noon.save(CFILE, config);
  console.log('Set option ' + chalk.white.bold(key) + ' to ' + chalk.white.bold(value) + '.');
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNtZHMvY29uZmlnX2NtZHMvc2V0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBTSxTQUFTLFFBQVEsY0FBUixDQUFmO0FBQ0EsSUFBTSxRQUFRLFFBQVEsYUFBUixDQUFkOztBQUVBLElBQU0sUUFBUSxRQUFRLE9BQVIsQ0FBZDtBQUNBLElBQU0sTUFBTSxRQUFRLE9BQVIsQ0FBWjtBQUNBLElBQU0sT0FBTyxRQUFRLE1BQVIsQ0FBYjs7QUFFQSxJQUFNLFFBQVcsUUFBUSxHQUFSLENBQVksSUFBdkIscUJBQU47O0FBRUEsUUFBUSxPQUFSLEdBQWtCLG1CQUFsQjtBQUNBLFFBQVEsSUFBUixHQUFlLG9CQUFmO0FBQ0EsUUFBUSxPQUFSLEdBQWtCLEVBQWxCO0FBQ0EsUUFBUSxPQUFSLEdBQWtCLFVBQUMsSUFBRCxFQUFVO0FBQzFCLE1BQU0sTUFBTSxLQUFLLEdBQWpCO0FBQ0EsTUFBSSxRQUFRLEtBQUssS0FBakI7QUFDQSxVQUFRLE1BQU0sWUFBTixDQUFtQixLQUFuQixDQUFSO0FBQ0EsUUFBTSxXQUFOLENBQWtCLEtBQWxCO0FBQ0EsTUFBTSxTQUFTLEtBQUssSUFBTCxDQUFVLEtBQVYsQ0FBZjtBQUNBLE1BQU0sUUFBUSxPQUFPLFNBQVAsQ0FBaUIsT0FBTyxLQUF4QixDQUFkO0FBQ0EsTUFBSSxPQUFPLE9BQVgsRUFBb0IsT0FBTyxTQUFQLENBQWlCLGVBQWpCLEVBQWtDLEtBQWxDLEVBQXlDLElBQXpDO0FBQ3BCLE1BQUksSUFBSSxNQUFKLENBQVcsTUFBWCxFQUFtQixHQUFuQixDQUFKLEVBQTZCO0FBQzNCLFFBQUksTUFBTSxJQUFOLENBQVcsR0FBWCxDQUFKLEVBQXFCO0FBQ25CLFVBQUksY0FBYyxJQUFkLENBQW1CLEdBQW5CLENBQUosRUFBNkI7QUFDM0IsY0FBTSxJQUFJLEtBQUosQ0FBVSwyQ0FBVixDQUFOO0FBQ0QsT0FGRCxNQUVPO0FBQ0wsWUFBSSxHQUFKLENBQVEsTUFBUixFQUFnQixHQUFoQixFQUFxQixLQUFyQjtBQUNEO0FBQ0YsS0FORCxNQU1PO0FBQ0wsYUFBTyxHQUFQLElBQWMsS0FBZDtBQUNEO0FBQ0YsR0FWRCxNQVVPO0FBQ0wsVUFBTSxJQUFJLEtBQUosYUFBb0IsR0FBcEIsaUJBQU47QUFDRDtBQUNELE9BQUssSUFBTCxDQUFVLEtBQVYsRUFBaUIsTUFBakI7QUFDQSxVQUFRLEdBQVIsaUJBQTBCLE1BQU0sS0FBTixDQUFZLElBQVosQ0FBaUIsR0FBakIsQ0FBMUIsWUFBc0QsTUFBTSxLQUFOLENBQVksSUFBWixDQUFpQixLQUFqQixDQUF0RDtBQUNELENBdkJEIiwiZmlsZSI6ImNtZHMvY29uZmlnX2NtZHMvc2V0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgdGhlbWVzID0gcmVxdWlyZSgnLi4vLi4vdGhlbWVzJylcbmNvbnN0IHRvb2xzID0gcmVxdWlyZSgnLi4vLi4vdG9vbHMnKVxuXG5jb25zdCBjaGFsayA9IHJlcXVpcmUoJ2NoYWxrJylcbmNvbnN0IGRvdCA9IHJlcXVpcmUoJ2RvdHR5JylcbmNvbnN0IG5vb24gPSByZXF1aXJlKCdub29uJylcblxuY29uc3QgQ0ZJTEUgPSBgJHtwcm9jZXNzLmVudi5IT01FfS8ubGV4aW1hdmVuLm5vb25gXG5cbmV4cG9ydHMuY29tbWFuZCA9ICdzZXQgPGtleT4gPHZhbHVlPidcbmV4cG9ydHMuZGVzYyA9ICdTZXQgYSBjb25maWcgdmFsdWUnXG5leHBvcnRzLmJ1aWxkZXIgPSB7fVxuZXhwb3J0cy5oYW5kbGVyID0gKGFyZ3YpID0+IHtcbiAgY29uc3Qga2V5ID0gYXJndi5rZXlcbiAgbGV0IHZhbHVlID0gYXJndi52YWx1ZVxuICB2YWx1ZSA9IHRvb2xzLmNoZWNrQm9vbGVhbih2YWx1ZSlcbiAgdG9vbHMuY2hlY2tDb25maWcoQ0ZJTEUpXG4gIGNvbnN0IGNvbmZpZyA9IG5vb24ubG9hZChDRklMRSlcbiAgY29uc3QgdGhlbWUgPSB0aGVtZXMubG9hZFRoZW1lKGNvbmZpZy50aGVtZSlcbiAgaWYgKGNvbmZpZy52ZXJib3NlKSB0aGVtZXMubGFiZWxEb3duKCdDb25maWd1cmF0aW9uJywgdGhlbWUsIG51bGwpXG4gIGlmIChkb3QuZXhpc3RzKGNvbmZpZywga2V5KSkge1xuICAgIGlmICgvXFwuL2kudGVzdChrZXkpKSB7XG4gICAgICBpZiAoL15cXHcqXFwuZGF0ZS9pLnRlc3Qoa2V5KSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBUEkgbGltaXRzIGhhcmRjb2RlZCwgY2FuJ3Qgc2V0IHRoaXMga2V5LlwiKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZG90LnB1dChjb25maWcsIGtleSwgdmFsdWUpXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbmZpZ1trZXldID0gdmFsdWVcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBPcHRpb24gJHtrZXl9IG5vdCBmb3VuZC5gKVxuICB9XG4gIG5vb24uc2F2ZShDRklMRSwgY29uZmlnKVxuICBjb25zb2xlLmxvZyhgU2V0IG9wdGlvbiAke2NoYWxrLndoaXRlLmJvbGQoa2V5KX0gdG8gJHtjaGFsay53aGl0ZS5ib2xkKHZhbHVlKX0uYClcbn1cbiJdfQ==